function Universe(e,t,n){"use strict";function r(){o(),a(),Object.setPrototypeOf(Universe.prototype,u.kjsclasses._primitive_prototype),Object.setPrototypeOf(Object.prototype,u)}function o(){var e=u.kjslib=_kJs_Initor(),t=u.kxmllib=_kXml_Initor(),n=u.kanilib=_kAni_Initor(),r=u.keventlib=_kEvent_Initor(),o=u.kgraphlib=_kGraph_Initor();i(e,"kjsclasses")(t,"kxmlclasses")(n,"kaniclasses")(r,"keventclasses")(o,"kgraphclasses")}function i(e,t){return u[t]=new e.ClassCollection,i}function a(){function e(e){return e=e.bind(n),function(t){var n=e(t);return e=i,n}}function t(e){for(var t=e.childNodes;t.length;)e.removeChild(e.firstChild)}function r(e){return parseFloat(e)+"px"}function o(e){return function t(n,r){return e[n]=r,Object.setPrototypeOf(r,e),t}}function i(){}u.ONCE_EXECUTER=e,u.clearChildren=t;u.Matrix=function(){function e(e,n){return new t(e,n)}function t(e,t){this.matR=e,this.startR=t}function n(e,t,r,o,i,a,u){for(var l=t+u;t!=l;++t,++o,++a)e[t]=r[o]+i[a];return n}function r(e,t,n){for(var o=n;e[t]=1,++t,1!=o;--o)for(var i=n;i;--i)e[t]=0,++t;return r}function i(e,t,n,r,o,a){var u=Math.cos(r),l=Math.sin(r);return e[p(t,o,o,n)]=+u,e[p(t,a,a,n)]=+u,e[p(t,o,a,n)]=-l,e[p(t,a,o,n)]=+l,i}function a(e,t,n,r,o,i){for(var u=t+o;t!=u;++t,++r)e[t]=i*n[r];return a}function u(e,t,n,r,o,i,a,l,s){for(var c=0;c!=a;++c)for(var f=0;f!=s;++f){for(var d=0,_=0;_!=l;++_)d+=n[p(r,c,_,a,l)]*o[p(i,_,f,l,s)];e[p(t,c,f,a,s)]=d}return u}function l(e,t,n,r,o,i,a,u,s,c){for(var f=0;f!=n;++f)for(var d=0;d!=r;++d)e[p(t,f,d,n)]=o[p(i,s+f,c+d,a,u)];return l}function s(e,t,n,r,o,i,a,u,l){var c=o+u;return f(e,t,c,l,0,0,n,r,o,l,0,0,o,l)(e,t,c,l,o,0,i,a,u,l,0,0,u,l),s}function c(e,t,n,r,o,i,a,u,l){var s=o+u;return f(e,t,l,s,0,0,n,r,l,o,0,0,l,o)(e,t,l,s,0,o,i,a,l,u,0,0,l,u),c}function f(e,t,n,r,o,i,a,u,l,s,c,d,_,m){for(var h=o+_,v=i+m,b=o,g=c;b!=h;++b,++g)for(var y=i,w=d;y!=v;++y,++w)e[p(t,b,y,n)]=a[p(u,g,w,l,s)];return f}function p(e,t,n,r){return e+t+r*n}var d={createCalculatingContext:e,__proto__:function(){var e={getArrayIndex:p,toString:function(){return"Matrix {}"}};return o(e)("add",n)("makeIdentity",r)("makeRotationMatrix",i)("scalarMultiply",a)("matrixMultiply",u)("subMatrix",l)("assembleRows",s)("assembleCols",c)("copyMatrix",f),e}()};return t.prototype={add:function(e,t,r,o,i){var a=this;return n(a.matR,a.startR,e,t,r,o,i),a},makeIdentity:function(e){var t=this;return r(t.matR,t.startR,e),t},makeRotationMatrix:function(e,t,n,r){var o=this;return i(o.matR,o.startR,e,t,n,r),o},scalarMultiply:function(e,t,n,r){var o=this;return a(o.matR,o.startR,e,t,n,r),o},matrixMultiply:function(e,t,n,r,o,i,a){var l=this;return u(l.matR,l.startR,e,t,n,r,o,i,a),l},subMatrix:function(e,t,n,r,o,i,a,u){var s=this;return l(s.matR,s.startR,e,t,n,r,i,o,a,u),s},assembleRows:function(e,t,n,r,o,i,a){var u=this;return s(u.matR,u.startR,e,t,n,r,o,i,a),u},assembleCols:function(e,t,n,r,o,i,a){var u=this;return c(u.matR,u.startR,e,t,n,r,o,i,a),u},copyMatrix:function(e,t,n,r,o,i,a,u,l,s,c,p){var d=this;return f(d.matR,d.startR,e,t,n,r,o,i,a,u,l,s,c,p),d},__proto__:d},Object.create(d)}();u.csspxform=r,u.createMethodAdder=o,u.donothing=i}if(!e.universe){var u=this;r()}}function Resources(e,t,n,r){"use strict";function o(){i(),a();var e=f.document_util=new kxmlclasses.DocumentUtil(t);return e.namespaceURI=t.documentElement.namespaceURI,u(kxmlclasses,kgraphclasses,e)?1:(s(l(kjsclasses,keventclasses),gl_util),0)}function i(){Object.setPrototypeOf(Resources.prototype,n),Object.setPrototypeOf(Object.prototype,f)}function a(){function e(e,t,n){return document_util.create({type:document_util.ELEMENT,tag:"div",parent:t,before:n,attributes:{id:"error-message"},children:[e]})}f.createErrMsgNode=e}function u(n,r,o){function i(){var t=e.innerWidth,n=e.innerHeight,r=n>t?t:n;requestAnimationFrame(function(){allglobjs.u_ratio.set(new Float32Array([n/r,t/r]))})}var a=f.canvas_container=o.create({type:o.ELEMENT,tag:"div",parent:t.body||t.documentElement.children[1],before:null,attributes:{id:"canvas-container"}}),u=f.canvas=o.create({type:o.ELEMENT,tag:"canvas",parent:a,before:null,attributes:{width:1024,height:1024,id:"main-canvas"},children:["Opps, your browser didn't supported HTMLCanvasElement."]}),l=f.gl=u.getContext("webgl");return l?(l.enable(l.CULL_FACE),e.addEventListener("resize",i,0),f.resizeCanvas=i,f.gl_util=new r.GLUtil(l),0):(u.parentNode.removeChild(u),o.create(createErrMsgNode("Your browser doesn't support WebGL or WebGL is disabled.",t.body,null)),1)}function l(e,t){function n(n,r){var o=this,i=o.xhrcount=new t.XHRCount(e.Republic.EXECUTE_ONLY_WHEN_ALL_REQUESTED(n.bind(o))),a=o.create=f.createxhr=i.create,u=o.vert=a("GET","./shader.vert",1),l=o.frag=a("GET","./shader.frag",1);r=ONCE_EXECUTER(r),u.addEventListener("error",r,0),l.addEventListener("error",r,0)}return f.AllXHRs=n,n}function s(e,n){function r(r,o){var i=this,a=new e(function(e){function o(e){throw console.debug(String(e)),console.log(e),e}var u=i.program_util=n.createProgramUtil({use:1,link:1,vertexShader:{source:a.vert.response,onerror:o},fragmentShader:{source:a.frag.response,onerror:o},onerror:o});!function(e,t){i.a_position=e("a_position",3,gl.FLOAT,0,0,0),i.u_rotation=[t("u_rotation[0]","fmat",4),t("u_rotation[1]","fmat",4),t("u_rotation[2]","fmat",4)],i.u_ratio=t("u_ratio","fvec",2),i.u_translate=t("u_translate","fvec",3),i.u_focal_length=t("u_focal_length","float",1),i.u_screen_distance=t("u_screen_distance","float",1),i.a_color=e("a_color",3,gl.FLOAT,0,0,0)}(u.createAttribUtil,u.createUniformUtil),c(kxmlclasses,document_util,t.body||t.documentElement.children[1]),r(i,a)},o)}return f.AllGLObjs=r,r}function c(n,o,i){!function(n,o){function a(e){var t=.02/3;return function(n){rotating_velocity[e]=n.value*t}}function u(t,r,i){function a(e){f();var t=e.screenX-h.left-m;return t>b?void(C.left=csspxform(b)):0>t?void(C.left="0px"):(C.left=csspxform(t),void u(t/b,e))}function u(e,t){p();var n=e*w+y;d.setAttributeNS(null,"value",String(n)),r({mousemove:t,value:n})}function s(){var e=parseFloat(d.getAttributeNS(null,"value"));C.left=csspxform(c(e))}function c(e){return f(),p(),b*(e-y)/w}function f(){h=d.getClientRects()[0],v=_.getClientRects()[0],b=h.width-v.width}function p(){y=parseFloat(d.getAttributeNS(null,"min")),g=parseFloat(d.getAttributeNS(null,"max")),w=g-y}t.id="slider-bar";var d=n({type:o,tag:"div",attributes:t});i&&i.forEach(function(e){var t=n({type:o,tag:"div",parent:d,before:null,attributes:{id:"checkpoint"},children:[String(e)]}).style;d.addEventListener("-k-appear",function(){t.left=csspxform(c(e))},0)});var _=n({type:o,tag:"div",parent:d,before:null,attributes:{id:"slider"}});l(_);var m,h,v,b,g,y,w,E=d.classList,C=_.style,S=_.classList;return _.addEventListener("mousedown",function(t){m=t.offsetX,E.add("holding"),S.add("holding"),e.addEventListener("mousemove",a,0)},0),e.addEventListener("mouseup",function(){E.remove("holding"),S.remove("holding"),e.removeEventListener("mousemove",a,0)},0),d.addEventListener("-k-appear",s,0),d}function l(t){var n=t.classList,r=e.document.documentElement.classList;n.add("grab"),t.addEventListener("mousedown",function(){n.remove("grab"),r.add("grabbing")},0),e.addEventListener("mouseup",function(){n.add("grab"),r.remove("grabbing")},0)}function s(e){return function(){C===e?p(e):(c(),d(e))}}function c(){p(g),p(w),p(E)}function p(e){C=r,e.classList.add("hidden"),h(e,"-k-disapear")}function d(e){C=e,e.classList.remove("hidden"),h(e,"-k-appear")}function _(e,t){return n({type:o,tag:"button",children:[t],event:{click:s(e)}})}function m(e,t){return n({type:o,tag:"a",attributes:{target:"_blank",href:e},children:[t||e]})}function h(e,t){var n=new Event(t),r=Function.call.bind(Array.prototype.map);return function o(e){return{element:e,succeed:e.dispatchEvent(n),children:r(e.children,o)}}(e)}function v(e){return n({type:o,tag:"div",attributes:{id:"readonly-text"},children:[e]})}function b(e){var t=e.set;return function(e){t(parseFloat(e.target.value))}}!function(t){function n(e){var n=allglobjs.u_ratio.get(),o=allglobjs.u_screen_distance.value/allglobjs.u_focal_length.value,i=(e.clientX-r.clientX)*o/n[0]/parseFloat(t.width),a=(e.clientY-r.clientY)*o/n[1]/parseFloat(t.height),u=allglobjs.u_translate,l=u.get();l[0]+=i,l[1]-=a,u.set(l),r=e}l(t);var r;t.addEventListener("mousedown",function(t){r=t,e.addEventListener("mousemove",n,0)},0),e.addEventListener("mouseup",e.removeEventListener.bind(e,"mousemove",n,0),0)}(canvas);var g=f.camera_dialog=n({type:o,tag:"div",parent:i,attributes:{id:"dialog",name:"camera"},children:[{type:o,tag:"iframe",attributes:{id:"image",type:"image/svg+xml",src:"camera-lens.svg"}},{type:o,tag:"input",attributes:{id:"focal-length",type:"text",placeholder:"focal_length",value:"2.0"},event:{change:b(allglobjs.u_focal_length)}},{type:o,tag:"input",attributes:{id:"screen-distance",type:"text",placeholder:"screen_distance",value:"2.0"},event:{change:b(allglobjs.u_screen_distance)}},{type:o,tag:"button",attributes:{id:"close"},event:{click:function(){p(g)}},children:["Close"]}]}),y=[-1,-.5,0,.5,1],w=f.rotating_velocity_dialog=n({type:o,tag:"div",parent:i,before:null,attributes:{id:"dialog",name:"rotating-velocity"},children:[{type:o,tag:"div",attributes:{id:"slider-container"},children:[v("Oy -> Oz:"),u({min:"-1.0",max:"+1.0",value:"+0.45"},a(0),y),v("Ox -> Oz:"),u({min:"-1.0",max:"+1.0",value:"+0.30"},a(1),y),v("Ox -> Oy:"),u({min:"-1.0",max:"+1.0",value:"+0.15"},a(2),y),{type:o,tag:"div",attributes:{id:"readonly-text",style:"text-align: center; font-size: 0.8em;"},children:["Drag sliders to adjust spinning speed and directions of the cube"]}]},{type:o,tag:"button",attributes:{id:"close"},event:{click:function(){p(w)}},children:["Close"]}]}),E=n({type:o,tag:"div",parent:i,before:null,attributes:{id:"dialog",name:"about"},children:[{type:o,tag:"h3",attributes:{style:"text-align: center; font-weight: normal;"},children:["3D Cube Demo"]},{type:o,tag:"div",children:[v("This is a demo which show usages of kjslibs"),v(["Source code of this demo: ",m("https://github.com/kjslibs/kjslibs.github.io/tree/master/apps/demos/cube-3d","kjslibs/apps/demos/cube-3d")]),v(["Repository kjslibs.github.io: ",m("https://github.com/kjslibs/kjslibs.github.io")]),v(["Author/Contributor: ",m("https://github.com/ksxgithub","Hoàng Văn Khải")]),v([v("This is free software; see the source for copying conditions."),v("There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.")])]},{type:o,tag:"button",attributes:{id:"close"},event:{click:function(){p(E)}},children:["Close"]}]});f.control_panel=n({type:o,tag:"div",parent:i,before:null,attributes:{id:"control-panel"},children:[_(g,"Camera"),_(w,"Spinning"),_(E,"About")]});!function(t){function n(){var n=e.innerWidth,i=e.innerHeight;t.left=csspxform(.5*(n-r)),t.top=csspxform(.5*(i-o))}var r=414.22,o=256;t.width=csspxform(r),t.height=csspxform(o),n(),e.addEventListener("resize",n,0)}(Array.prototype.find.call(t.styleSheets[0].cssRules,function(e){return"#dialog"==e.selectorText}).style),c();var C}(o.create,o.ELEMENT)}if(!e.resources){var f=this;if(o())throw f._error=1,"Bad support browser."}}function PatternCollection(){"use strict";function e(){t(),n()}function t(){Object.setPrototypeOf(PatternCollection.prototype,resources),Object.setPrototypeOf(Object.prototype,r)}function n(){r.cube_pattern=new Float32Array([-1,-1,-1,-1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,-1,-1,-1,-1,-1,1,1,-1,1,-1,-1,-1,1,-1,1,1,-1,-1,-1,-1,-1,1,-1,-1,1,1,-1,-1,-1,-1,1,1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,1,1,1,-1,-1,1,1,1,1,1,-1,-1,1,-1,1,1,-1,1,1,1,-1,1,-1,1,1,1,-1,1,1,-1,-1,1,-1,1,1,1,1,1,-1,-1,1,1,1,1,1,-1,1])}if(!window.patterncollection){var r=this;e()}}function main(e,t,n){"use strict";function r(r){function o(){function n(e,t,n){o(0,e,1,2),o(1,t,0,2),o(2,n,0,1)}function o(e,t,n,o){Matrix.makeRotationMatrix(a[e],0,4,t,n,o),r.u_rotation[e].value=a[e]}function i(){n(u[0],u[1],u[2])}var a=[new t(16),new t(16),new t(16)],u=new t([-.25*Math.PI,-.25*Math.PI,-.25*Math.PI]);this.matrices=a,this.param=e.rotatorparam=u,this.animate=e.rotatorani=new kaniclasses.Animate(i),this.makeRotation=n,Matrix.makeIdentity(a[0],0,4)(a[1],0,4)(a[2],0,4)}var i=e.color=new t(cube_pattern.length),a=e.define_color=function(){function e(){function e(t,n,o){return r(t)(n)(o),e}function t(n){return e(n[0],n[1],n[2]),t}function n(e){return"number"!=typeof e?a:(a=e,n)}function r(e){return i[a]=e,++a,r}var o=this,a=0;createMethodAdder(o)("addColor3f",e)("addColor3fv",t)("pointer",n)}function r(e,n,r){return new t([e,n,r])}function o(e,n,r){function o(t){i[t]=e(n[t],r[t])}var i=new t(3);return o(0),o(1),o(2),i}function a(e){return o.bind(n,e)}return e.prototype={RED:r(1,0,0),GREEN:r(0,1,0),BLUE:r(0,0,1),mix:o,mixBright:a(function(e,t){return e+t}),mixAvg:a(function(e,t){return.5*(e+t)}),mixDark:a(function(e,t){return 1-e-t})},new e}();!function(e,t,n,r){var o=r(t,n),i=r(e,n),u=r(e,t);a.pointer(0).addColor3fv(e)(e)(e)(e)(e)(e)(t)(t)(t)(t)(t)(t)(n)(n)(n)(n)(n)(n)(o)(o)(o)(o)(o)(o)(i)(i)(i)(i)(i)(i)(u)(u)(u)(u)(u)(u)}(a.RED,a.GREEN,a.BLUE,a.mixAvg),resizeCanvas();var u=new t(cube_pattern.length);Matrix.scalarMultiply(u,0,cube_pattern,0,cube_pattern.length,.3),function(e,t,n,r){e.createBufferUtil(n,r,u),e.active(),t.createBufferUtil(n,r,i),t.active()}(r.a_position,r.a_color,gl.ARRAY_BUFFER,gl.STATIC_DRAW),function(n){var r=36,i=new n.Animate(function(e){gl.drawArrays(gl.TRIANGLES,0,r)}),a=e.rotator=new o,u=e.autorotationani=function(r,o){function i(e,t,n){e[n]+=t[n]*a,e[n]%=o}var a,u=e.rotating_velocity=new t([.003,.002,.001]);return new n.VectorAnimator(function(e,t,n){a=n.duration,i(e,t,0),i(e,t,1),i(e,t,2)}).createAnimate(r,u)}(a.param,2*Math.PI);i.run(),a.animate.run(),u.run()}(kaniclasses),r.u_focal_length.value=2,r.u_screen_distance.value=2}function o(){var e=document.body;clearChildren(e),e.insertBefore(createErrMsgNode("ERROR 404: Resources Not Found."),null)}e.__badsupport&&alert("Your browser does not support some important features.\nIt's time to change your browser."),e.allglobjs=new AllGLObjs(r,o),console.log("Load done.")}!function(e,t){function n(e,t){this.key=e,this.val=t}function r(){throw new Error("This feature is not yet (and maybe never) supported.")}if(e.__badsupport=0,function(t){t.hasOwnProperty("currentScript")||(++e.__badsupport,Object.defineProperty(t,"currentScript",{get:function(){var e=this.getElementsByTagName("script");return e[e.length-1]}}))}(Document.prototype),function(t){t.find||(++e.__badsupport,t.find=function(e){var t;return this.some(function(n,r,o){return e.call(n,r,o)?(t=n,1):void 0}),t},Object.getOwnPropertySymbols=function(){return[]})}(Array.prototype),!e.Symbol){++e.__badsupport;var o=0;e.Symbol=function(t){var t="@@{"+(t?String(t):"")+"}"+String.fromCharCode(o);return++o,{toString:function(){return t},__proto__:e.Symbol.prototype}}}e.Map||(++e.__badsupport,e.Map=function(){this.__keyvals=0},e.Map.prototype={clear:function(){this.__keyvals.length=0},"delete":function(e){return this.__keyvals.some(function(t,n,r){return t.key===e?(r.splice(n,1),!0):!1})},entries:r,forEach:function(e){var t=this;t.__keyvals.forEach(function(n){e(n.key,n.val,t)})},get:function(e){var t=this.__findKeyVal(e);return t?t.val:void 0},set:function(e,t){var r=this.__findKeyVal(e);return r?r.val=t:this.__keyvals.push(new n(e,t)),this},values:r,__findKeyVal:function(e){return this.__keyvals.find(function(t){return t.key===e})}},e.Map.prototype[Symbol.iterator]=r)}(window),function(e,t,n,r,o,i,a){"use strict";function u(){return te(this)}function l(e){ne(this,e)}function s(e,t){je(e,new a),e.prototype=t}function c(e,t){var n=Me.get(e);if(n.has(t))throw new TypeError("Can't re-construct object. 'new' operator is required.");n.add(t)}function f(e,t,n){if(!p(e,t))throw new TypeError(n)}function p(e,t){var n=Le(e);return n&&n.has(t)}function d(e,t,n,r,o){if(!this)return new d(e,t,n,r,o);var i=Te(this);i("get",function(){return e[t]}),n||i("set",function(n){e[t]=n}),i("enumerable",Boolean(r)),i("configurable",Boolean(o))}function _(e,t,n){var r=Te(e);Ce(t,function(e){r(e,n)})}function m(e,t){return e[t].bind(e)}function h(e,t,n){Se(e,n,m(t,n))}function v(e,t,n,r){var o=Te(e),i=m(n,r);o(t,i),o(r,i)}function b(e,t,n,r,o,i,a){z(e,t,new d(n,r,o,i,a))}function g(e,t,n,r,o,i){z(e,t,{set:r?X:Oe?w(n):C(e,n),get:Oe?E(n):S(e,n),enumerable:Boolean(o),configurable:Boolean(i),__proto__:null})}function y(e,t,n,r,o){z(e,t,{configurable:Boolean(o),enumerable:Boolean(r),get:function(){return this[n]},set:function(e){this[n]=e},__proto__:null})}function w(e){return function(t){return this[e]=t}}function E(e){return function(){return this[e]}}function C(e,t){return function(n){return e[t]=n}}function S(e,t){return function(){return e[t]}}function k(){return this.user_manuals.join("\n	")}function A(e){return e&&"object"==typeof e&&Q(e)}function R(e){switch(e){case X:case null:return!1}return"function"==typeof e.call&&"function"==typeof e.apply&&"function"==typeof e.bind?!0:void 0}function P(e,t,n){return(n||(n=ae)).value=t,z(this,e,n),this}function T(e,t,n){if(!A(this)&&"function"!=typeof this)throw new TypeError("Object must be extensible.");var r=this;return Ae(e,function(e){var n=e[lt];Se(r,n,this[n],t)},n)}function M(e,t){if(!A(this)&&"function"!=typeof this)throw new TypeError("Object must be extensible.");var n=this;return Ae(e,function(t){var r=t[lt];z(n,r,ee(e,r))},t)}function I(e,t){var n=dt.get(this);return n?n.some(function(n,r,o){return t===e?(o.splice(r,0,e),!0):!1})||n.push(e):dt.set(this,[e]),this}function j(e){var t=dt.get(this);return t&&t.splice(t.indexOf(e),1),this}function L(){var e=dt.get(this);return e&&(e.length=0),this}function x(e){function t(t){return o[lt]=t,r.some(n,e),o[st]>0&&(--o[-key_jump],!0)}function n(e,t){return e.call(this,o),o[st]>0&&(--o[st],!0)}var r=dt.get(this),o=new N(e,this);return Ue=o,r&&(e||(e=this),$(this).some(t)||Z(this).some(t))?this:this}function N(e,t){this[at]=e,this[ut]=t}function O(e,t){this.object=e,this.handler=t;var n=this.unrequested=new a;this.__add=be.bind(n),this.__delete=ge.bind(n),xe(e,this)}function U(e){if(!A(this))return new U(e);if(!R(e))throw new TypeError("arguments[0] is not a valid handler.");if(e=e.bind(this),"function"!=typeof e)throw new TypeError("handler.bind() must return a function.");c(U,this);var t=new O(this,e);v(this,Qe,t,"add"),v(this,Ze,t,"remove"),v(this,et,t,"execute")}function F(e){this.object=e,this.__forEach=ye.bind(this.entered=new a),xe(e,this)}function D(){if(!A(this))return new D;c(D,this);var e=new F(this);v(this,Qe,e,"enter"),v(this,Ze,e,"leave"),v(this,tt,e,"request"),v(this,nt,e,"unrequest"),v(this,et,e,"update")}function q(){return _t||this}function B(){return mt||this}function G(e){if(!A(e))throw new TypeError("arguments[0] must be extensible.");return ht.has(e)?this:(ht.add(e),ke(e,re),Re(re),Pe(re),this)}function V(e){if(!A(e))throw new TypeError("arguments[0] must be extensible.");return vt.has(e)?this:(vt.add(e),ke(e,oe),Re(oe),Pe(oe),Se(e,"_kJs_primitivePrototype",Y),Se(e,Xe,Y),this)}function H(){return bt||this}function J(){if(gt)return gt;var e=Te(this);return e("SymbolCollection",q),e(De,q),e("FunctionCollection",B),e(qe,B),G(this),e("ReleaseMethods",G),e(Be,G),V(this),e("ReleaseClasses",V),e(Ge,V),e("ClassCollection",H),e(Ve,H),gt=this}var X,W=t.create,Y=W(null),z=t.defineProperty,K=(t.defineProperties,t.freeze),Q=(t.seal,t.preventExtensions,t.isFrozen,t.isSealed,t.isExtensible),Z=t.getOwnPropertyNames,$=t.getOwnPropertySymbols,ee=t.getOwnPropertyDescriptor,te=t.getPrototypeOf,ne=t.setPrototypeOf,re=(r.iterator,Math.ceil,Math.max,Math.min,W(null)),oe=W(null),ie=W(Y),ae={enumerable:!1,writable:!1,configurable:!1,__proto__:Y},ue=t.prototype,le=n.prototype,se=o.prototype,ce=i.prototype,fe=a.prototype,pe={get:u,set:l,__proto__:null},de=(ue.hasOwnProperty,le.call),_e=(le.apply,le.bind),me=se.map,he=ce.set,ve=ce.get,be=(ce["delete"],ce.forEach,fe.add),ge=fe["delete"],ye=fe.forEach,we=_e.bind(_e),Ee=we(de),Ce=Ee(me),Se=Ee(P),ke=Ee(T),Ae=Ee(I),Re=Ee(x),Pe=Ee(L),Te=we(P),Me=new i,Ie=new i,je=he.bind(Me),Le=ve.bind(Me),xe=he.bind(Ie),Ne=ve.bind(Ie);d.prototype=K({get:null,set:null,readonly:!1,enumerable:!1,configurable:!1,__proto__:null});var Oe=!1;k.toString=k,k.user_manuals="This method which called 'toString', simply join the value stored in 'object.user_manuals' as an instance of 'Array'";var Ue=null,Fe=r("Initor"),De=r("SymbolCollection"),qe=r("FunctionCollection"),Be=r("ReleaseMethods"),Ge=r("ReleaseClasses"),Ve=r("ClassCollection"),He=r("created instance"),Je=r("__proto__"),Xe=r("primitive prototype"),We=r("create"),Ye=r("setConst"),ze=r("addSetConsts"),Ke=r("addDefPro"),Qe=r("add member"),Ze=r("remove member"),$e=r("clear all members"),et=r("update and run"),tt=r("request"),nt=r("unrequest"),rt=r("enable"),ot=r("disable"),it=r("check if enabled, set enable/disable"),at=r("arguments"),ut=r("self"),lt=r("key as Symbol or String"),st=r("jump as Integer"),ct=W(se);ct.length=0;var ft=K({Initor:Fe,SymbolCollection:De,FunctionCollection:qe,ReleaseMethods:Be,ReleaseClasses:Ge,ClassCollection:Ve,createdInstance:He,proto:Je,primitivePrototype:Xe,create:We,setConst:Ye,addSetConsts:ze,addDefPro:Ke,addMember:Qe,removeMember:Ze,clear:$e,update:et,request:tt,unrequest:nt,enable:rt,disable:ot,enabled:it,args:at,self:ut,jump:st,__proto__:null}),pt=K({is_extensible_object:A,is_valid_handler:R,Initor:J,SymbolCollection:q,FunctionCollection:B,ReleaseClasses:V,ReleaseMethods:G,shared_toString:k,_prvEnsureConstructor:f,_prvCheckConstructorInstance:p,_proto_descriptor:(pe.set(null),K(pe)),_proto_getter:u,_proto_setter:l,_DescriptorGetterSetter1os3b:d,_setconst1oVs1v:_,_bindmtdbyname:m,_setmtdfromcore2o1s:h,_setmtdfromcore2os:v,_setkeytokey2os3b:b,_setkeytokey1o2s3b:g,_setkeytokey1o2s3b_inheritable:function(e){Oe=Boolean(e)},_defgettersetter1o2s:y,_setter:w,_getter:E,_setter_of:C,_getter_of:S,__function_callbind:Ee,__setConst:Se,__addSetConsts:ke,__insertPropertyMapperBefore:Ae,__executePropertyMappers:Re,__clearAllPropertyMappers:Pe,__proto__:null});re[Ye]=re._kJs_setConst=P,P.toString=k,P.user_manuals=["void Dictionary::setConst(String name, String value, optional DataPropertyDescriptor descriptor);"],re[ze]=re._kJs_addSetConsts=T,T.toString=k,T.user_manuals=["void Dictionary::addSetConsts(Dictionary clone_target, optional Object descriptor, optional PropertyMapper position)","typedef function<Dictionary, PropertyMapperParam> PropertyMapper;","What this method does is adding a setting-constant handler before position","Call _kJs_insertPropertyMapperBefore.call(clone_target) to apply"],re[Ke]=re._kJs_addDefPro=M,M.toString=k,M.user_manuals=["void Dictionary::addDefPro(Dictionary clone_target, optional PropertyMapper position);","typedef function<Dictionary, PropertyMapperParam> PropertyMapper;","copy all own properties from clone_target to the object by getting their property-descriptor","Call _kJs_insertPropertyMapperBefore.call(clone_target) to apply"];var dt=new i;re._kJs_insertPropertyMapperBefore=I,I.toString=k,I.user_manuals=["void Dictionary::insertPropertyMapperBefore(PropertyMapper handler, optional PropertyMapper position);","typedef function<Dictionary, PropertyMapperParam> PropertyMapper;","When call _kJs_executePropertyMappers, 'handler' will be called before 'position' is called","Handler may skip the rest of executing handler list by assigning arguments[0].jump to 1","Handler may stop the executing process by assigning arguments[0].jump to 2"],re._kJs_removePropertyMapper=j,j.toString=k,j.user_manuals=["void Dictionary::removePropertyMapper(Handler handler)","removed handler would not execute when call _kJs_executePropertyMappers"],re._kJs_clearAllPropertyMappers=L,L.toString=k,L.user_manuals=["void Dictionary::clearAllPropertyMappers();","clear all inserted property mappers"],re._kJs_executePropertyMappers=x,x.toString=k,x.user_manuals=["void Dictionary::executePropertyMappers(optional Object args);","execute all handlers which have been inserted before","Handler may skip the rest of executing handler list by assigning arguments[0].continue to true","Handler may stop the executing process by assigning arguments[0].break to true"],function(e){var t=re._kJs_prvPropertyMapperParam_prototype=e.prototype=W(Y);Oe=!0,g(t,"args",at),g(t,"self",ut),g(t,"property",lt),g(t,"jump",st),t[at]=null,t[ut]=null,t[lt]=null,t[st]=0}(N),O.prototype=W({__add:null,__delete:null,_add:function(e){this.__add(e)},_remove:function(e){this.__delete(e)},object:null,handler:null,unrequested:null,add:function(e){return f(D,e,"arguments[0] is not an instance of Civilian"),Ne(e)._enter(this),this.object},remove:function(e){return f(D,e,"arguments[0] is not an instance of Civilian"),Ne(e)._leave(this),this.object},execute:function(){return this.handler(this.unrequested.size)},__proto__:null}),s(U,function(e){var t=Te(e);return t("add",null),t("remove",null),t("execute",null),t(Qe,null),t(Ze,null),t(et,null),e}(W(Y))),oe._kJs_Republic=ie.Republic=U,U.toString=k,U.user_manuals=["constructor Republic(function<void, Republic, uint> handler);","void add(Civilian civilian);","void remove(Civilian civilian);","any execute();"],function Et(e){var t=Te(e);return t("EXECUTE_CASE_ALL_OR_NO",function(e,t){if(!R(e))throw new TypeError("arguments[0] is not a valid handler.");if(!R(t))throw new TypeError("arguments[1] is not a valid handler.");return e=e.bind(X),t=t.bind(X),function(n){return(n?t:e)(this)}}),t("EXECUTE_ONLY_WHEN_ALL_REQUESTED",function(e){if(!R(e))throw new TypeError("arguments[0] is not a valid handler.");return e=e.bind(X),function(t){return t?X:e(this)}}),t("EXECUTE_ONLY_WHEN_NO_REQUESTED",function(e){if(!R(e))throw new TypeError("arguments[0] is not a valid handler.");return e=e.bind(this),function(t){return t?e(this):null}}),Et}(U)(U.prototype),F.prototype=W({__forEach:null,_enter:function(e){var t=this.entered;t.has(e)||(e._add(this),t.add(e))},_leave:function(e){var t=this.entered;t.has(e)&&(e._remove(this),t["delete"](e))},entered:null,object:null,enter:function(e){return f(U,e,"arguments[0] is not an instance of Republic"),this._enter(Ne(e)),this.object},leave:function(e){return f(U,e,"arguments[0] is not an instance of Republic"),this._leave(Ne(e)),this.object},request:function(){var e=this;return e.entered.forEach(function(t){t._remove(e)}),e.object},unrequest:function(){var e=this;return e.entered.forEach(function(t){t._add(e)}),e.object},update:function(){return this.__forEach(function(e){e.execute()}),this.object},__proto__:null}),s(D,function(e){var t=Te(e);return t("enter",null),t("leave",null),t("request",null),t("unrequest",null),t("update",null),t(Qe,null),t(Ze,null),t(tt,null),t(nt,null),t(et,null),e}(W(Y))),oe._kJs_Civilian=ie.Civilian=D,D.toString=k,D.user_manuals=["constructor Civilian();","void enter(Republic set);","void leave(Republic set);","void request();","void unrequest();","void update();"];var _t=null;q.prototype=ft,q.toString=k,q.user_manuals=["constructor Initor::SymbolCollection();","Return value: An object which contains all keys"],q[He]=q.created=_t=K(new q),K(q);var mt=null;B.prototype=pt,B.toString=k,B.user_manuals=["function Initor::FunctionCollection();","Return value: An object which contains all utility functions"],B.prototype=pt,B[He]=B.created=mt=new B,K(B);var ht=new a;G.toString=k,G.user_manuals=["function Initor::ReleaseMethods(Object object);","Implement all methods from -k-js-abstract.js"],z(Y,Je,pe),z(Y,"__proto__",pe);var vt=new a;V.toString=k,V.user_manuals=["function Initor::ReleaseClasses(Object object);","Release all classes from -k-js-abstract.js to object"],ie._primitive_prototype=ie[Xe]=Y;var bt=null;H.prototype=K(ie),H.toString=k,H.user_manuals=["constructor Initor::ClassCollection();","Return a class collection"],H[He]=H.created=bt=K(new H),K(H);var gt=null,yt=e.document.currentScript,wt=yt.getAttributeNS(null,"kjslib-keyword")||"_kJs_Initor";e[wt]=e[Fe]=J,J.toString=k,J.user_manuals=["constructor Initor();","This constructor is used for create initor of -k-js-abstract.js","Call this constructor once for all"],J.prototype=W(Y),J[He]=J.created=gt=K(new J),K(J),G(Y)}(window,Object,Function,Symbol,Array,Map,Set),function(e,t,n,r,o,i,a,u,l,s,c){"use strict";function f(e,t){dt(e,new i),e.prototype=t}function p(e,t){var n=ft.get(e);if(n.has(t))throw new TypeError("Can't re-construct object. 'new' operator is required.");n.add(t)}function d(e,t,n){if(!_(e,t))throw new TypeError(n)}function _(e,t){var n=_t(e);return n&&n.has(t)}function m(e){var t=ae(e);return t("ELEMENT",gt),t("ATTRIBUTE",yt),t("TEXT",wt),t("DOCUMENT_FRAGMENT",Et),t("COMMENT",Ct),e}function h(e,n){if(n instanceof u)return n;if(null===n)return null;if("object"==typeof n){if("number"==typeof n.length)return y(e,n);var r=null,o=n.namespaceURI;switch(o===U&&(o=St===U?e.namespaceURI:St),n.type){case gt:r=v(e,o,n.tag,n.attributes,n.children);break;case yt:r=b(e,o,n.name,n.value);break;case wt:r=g(e,n.value);break;case Et:r=y(e,n.children);break;case Ct:r=xe(e,n.value);break;default:return null}var i=n.parent,l=n.before;return function(){if(i===U){if(l===U||null===l)return;l=h(e,l),i=l.parentNode}else l===U&&(l=null),i=h(e,i);Ce(i,r,l)}(),function(e){"object"==typeof e&&e&&W(e).forEach(function(n){!function o(e){if("function"==typeof e)return r.addEventListener(n,e,!1);if("object"==typeof e&&e)return e instanceof a||t.getPrototypeOf(e)===pe?e.forEach(o):void r.addEventListener(n,e.listener,e.useCapture)}(e[n])})}(n.event),r}return je(e,String(n))}function v(e,t,n,r,o){var i=Me(e,t,n);if(r){var a=Oe.bind(i);W(r).forEach(function(e){var t=r[e];switch(t){case U:case null:a(null,e,"");break;default:"object"==typeof t?a(t.namespaceURI||null,e,String(t.value)):a(null,e,String(t))}})}return o&&ye(o,function(e){S(e,i)}),i}function b(e,t,n,r){var o=Ie(e,t,n);return"object"!=typeof r&&(o.value=r),o}function g(e,t){return je(e,String(t))}function y(e,t){var n=Le(e);return"object"==typeof t&&t?(ye(t,function(e){S(e,n)}),n):n}function w(e){function t(){return o}function n(e){o=null===e?e:String(e)}if(!ne(this))return new w(e);if(!(e instanceof l))throw new TypeError("arguments[0] must be an document");var r=this;p(w,r),mt(r,[Ze,"document"],e);var o=e.namespaceURI;mt(r,[et,"getNamespaceURI"],t),mt(r,[tt,"setNamespaceURI"],n);var i={get:t,set:n,__proto__:null};J(r,"namespaceURI",i),J(r,$e,i),mt(r,[Ve,nt,"create","createNode"],function(t){St=o;var n=h(e,t);return St=U,n}),mt(r,[rt,"createElement"],function(t,n,r){return v(e,o,t,n,r)}),mt(r,[ot,"createAttribute"],function(t,n){return b(e,o,t,n)}),mt(r,[it,"createTextNode"],function(t){return g(e,t)}),mt(r,[at,"createDocumentFragment"],function(t){return y(e,t)})}function E(e,t,n){if(e instanceof u)return Ce(t,e,n);if(null===e)return null;if("string"==typeof e)return Ce(t,je(t.ownerDocument,e),n);var r=e.forEach;if(re(r))return r.call(e,function(e){E(e,t,n)}),e;var o=e[Ge];if(re(i)){for(var i=o.bind(e);;){var a=i.next();if(a.done)break;E(a.value,t,n)}return e}var l=e.length;return isFinite(l)&&!(l%1)&&l>=0?(ye(e,function(e){E(e,t,n)}),e):(e=h(t.ownerDocument,e),e instanceof c?De(t,e):Ce(t,e,n))}function C(e,t){return E(e,t.parentNode,t)}function S(e,t){return E(e,t,null)}function k(e,t,n){t=t.bind(e),n>>=0,R(e,function(e,r){t(new P(e,r,n+1))}),ye(e.childNodes||[],function(e,r){t(new P(e,r,++n)),k(e,t,n--)})}function A(e,t,n,r){t=t.bind(e),n>>=0,ye(r?e.children:e.childNodes||[],function(e,o){t(new P(e,o,++n)),A(e,t,n--,r)})}function R(e,t){t=t.bind(e),ye(e.attributes||[],function(e,n){t(e,n)})}function P(e,t,n){var r=ae(this);r("node",e),r("index",t),r("level",n)}function T(e,t){if(!e)return!1;t=t.bind(e);var n=e.parentNode;return t(n)||T(n,t)}function M(e,t){if(!isFinite(t))throw new TypeError(t+" is not a valid number.");var n=null;return T(e,function(e){return--t<1&&(n=e,!0)}),n}function I(e){function t(t,r){return E(t,e,r),n}if(!ne(this))return new I(e);var n=this;p(I,n);var r=ae(n);mt(n,[Ze,"element"],e),mt(n,[He,"append"],t),mt(n,[Je,"remove"],function(t){return Se(e,t),n}),mt(n,[lt,"tree"],function(t){return k(e,t.bind(n)),n}),r("allChildren",function(t){
return A(e,t.bind(n)),n}),r("allAttributes",function(t){return R(e,t.bind(n)),n}),r("allParent",function(t){return T(e,t.bind(n)),n}),r("parentLevel",function(t){return M(e,t)})}function j(){return kt||this}function L(){return At||this}function x(e){if(!ne(e))throw new TypeError("arguments[0] must be extensible.");return Rt.has(e)?this:(Rt.add(e),le(e,qe),se(qe),ce(qe),ue(e,"_kXml_primitivePrototype",z),this)}function N(){return Pt||this}function O(){if(Tt)return Tt;var e=ae(this);return e("SymbolCollection",j),e(Xe,j),e("FunctionCollection",L),e(We,L),x(this),e("ReleaseClasses",x),e(Ye,x),e("ClassCollection",N),e(ze,N),Tt=this}var U,F=e.document.currentScript,D=e[F.getAttributeNS(null,"kjslib-keyword")||"_kJs_Initor"];if(!D)throw new Error("-k-js-abstract.js is required.");var q=F.getAttributeNS(null,"kxmllib-keyword")||"_kXml_Initor",B=new D,G=B.SymbolCollection(),V=B.FunctionCollection(),H=t.create,J=t.defineProperty,X=t.setPrototypeOf,W=t.getOwnPropertyNames,Y=B.ClassCollection(),z=H(Y._primitive_prototype),K=H(z);B.ReleaseMethods(z),B.ReleaseMethods(K);var Q=n.prototype,Z=Q.call,$=Q.bind,ee=$.bind(Z),te=V.shared_toString,ne=V.is_extensible_object,re=V.is_valid_handler,oe=t.freeze,ie=K._kJs_setConst,ae=$.bind(ie),ue=V.__setConst,le=V.__addSetConsts,se=V.__executePropertyMappers,ce=V.__clearAllPropertyMappers,fe=(K._kJs_addSetConsts,K._kJs_executePropertyMappers,K._kJs_clearAllPropertyMappers,o.prototype),pe=i.prototype,de=a.prototype,_e=u.prototype,me=l.prototype,he=s.prototype,ve=fe.get,be=fe.set,ge=(fe["delete"],fe.forEach,fe.clear,pe.add,pe["delete"],pe.has,de.forEach),ye=ee(ge),we=_e.insertBefore,Ee=_e.removeChild,Ce=ee(we),Se=ee(Ee),ke=me.createElementNS,Ae=me.createAttributeNS,Re=me.createTextNode,Pe=me.createDocumentFragment,Te=me.createComment,Me=ee(ke),Ie=ee(Ae),je=ee(Re),Le=ee(Pe),xe=ee(Te),Ne=he.getAttributeNS,Oe=he.setAttributeNS,Ue=he.getAttributeNode,Fe=he.setAttributeNode,De=(ee(Ne),ee(Oe),ee(Ue),ee(Fe)),qe=(H(null),H(null)),Be=H(z),Ge=r.iterator,Ve=G.create,He=G.addMember,Je=G.removeMember,Xe=(G.update,G.request,G.unrequest,G.enable,G.disable,G.enabled,G.SymbolCollection),We=G.FunctionCollection,Ye=G.ReleaseClasses,ze=G.ClassCollection,Ke=G.createdInstance,Qe=G.primitivePrototype,He=G.addMember,Je=G.removeMember,Ze=r("Base DOM Node"),$e=r("Namespace URI"),et=r("Get namespace URI"),tt=r("Set namespace URI"),nt=r("create a DOM Node"),rt=r("create a DOM Element"),ot=r("create a DOM Attribute"),it=r("create a DOM Text Node"),at=r("create a #document-fracment"),ut=r("move to new place"),lt=r("browse a tree"),st=oe({node:Ze,xmlns:$e,getXmlns:et,setXmlns:tt,createNode:nt,createElement:rt,createAttribute:ot,createTextNode:it,createDocumentFragment:at,move:ut,tree:lt,__proto__:null}),ct=oe({_prvEnsureConstructor:d,_prvCheckConstructorInstance:_,__proto__:null}),ft=new o,pt=new o,dt=be.bind(ft),_t=ve.bind(ft),mt=(be.bind(pt),ve.bind(pt),V._setconst1oVs1v),ht=F.getAttributeNS(null,"kxml-enum-type");ht&&(ht=ht.toLocaleString());var vt,bt;switch(ht){case"int":case"integer":case"number":!function(){var e=0,t=0;vt=function(){var t=e;return e+=1<<level,t},bt=function(n){e=0,t=n>>0}}();break;default:e.console.warn("Attribute 'kxml-enum-type' of this script element is set to an invalid value. Enum type will be Symbol by default.",F,F.getAttributeNodeNS(null,"kxml-enum-type"));case null:case"symbol":vt=function(e){return r(e)},bt=Q}bt(0);var gt=vt("DocumentUtil.ELEMENT"),yt=vt("DocumentUtil.ATTRIBUTE"),wt=vt("DocumentUtil.TEXT"),Et=vt("DocumentUtil.DOCUMENT_FRAGMENT"),Ct=vt("DocumentUtil.COMMENT");!function(e){var t=ae(e);t("createNode",h),t("createElement",v),t("createTextNode",g)}(w),function(e,t){var n=m(H(Q));X(e,n),X(t,n)}(h,w);var St=U;f(w,function(e){var t=ae(e);return m(e),t("document",null),t("getNamespaceURI",null),t("setNamespaceURI",null),t("namespaceURI",null),t("create",h),t("createNode",h),t("createElement",v),t("createAttribute",b),t("createTextNode",g),t("createDocumentFragment",y),t(Ze,null),t(et,null),t(tt,null),t($e,null),t(Ve,h),t(nt,h),t(rt,v),t(ot,b),t(it,g),t(at,y),e}(H(z))),qe._kXml_DocumentUtil=Be.DocumentUtil=w,w.toString=te,w.user_manuals=["constructor DocumentUtil(Document document);"],function(e){I._prvTreeParam_prototype=P.prototype=e;var t=ae(e);t("node",null),t("index",null),t("level",null)}(H(null)),function(e){var t=ae(e);t("insertNode",E),t("insertNodeBefore",C),t("insertNodeBack",S),t("tree",k),t("allChildren",A),t("allAttributes",R),t("allParent",T),t("parentLevel",M)}(I),f(I,function(e){var t=ae(e);return t("element",null),t("append",null),t("remove",null),t("tree",null),t("allChildren",null),t("allParent",null),t("parentLevel",null),t(Ze,null),t(He,null),t(Je,null),t(lt,null),e}(H(z))),qe._kXml_ElementUtil=Be.ElementUtil=I,I.toString=te,I.user_manuals=["constructor ElementUtil(Element element);"];var kt=null;j.prototype=st,j.toString=te,j.user_manuals=["constructor Initor::SymbolCollection();"],j[Ke]=j.created=kt=new j,oe(j);var At=null;L.prototype=ct,L.toString=te,L.user_manuals=["constructor Initor::FunctionCollection();"],L[Ke]=L.created=At=new L,oe(L);var Rt=new i;x.toString=te,x.user_manuals=["constructor Initor::ReleaseClasses(Object object);"],Be._primitive_prototype=Be[Qe]=z;var Pt=null;N.prototype=oe(Be),N.toString=te,N.user_manuals=["constructor Initor::ClassCollection();"],N[Ke]=N.created=Pt=oe(new N),oe(N);var Tt=null;e[q]=O,O.toString=te,O.user_manuals=["constructor Initor();"],O.prototype=H(z),O[Ke]=O.created=Tt=oe(new O),oe(O)}(window,Object,Function,Symbol,Map,Set,Array,Node,Document,Element,Attr),function(e,t,n,r,o,i){"use strict";function a(e,t){Ae(e,new i),e.prototype=t}function u(e,t){var n=Se.get(e);if(n.has(t))throw new TypeError("Can't re-construct object. 'new' operator is required.");n.add(t)}function l(e,t,n){if(!s(e,t))throw new TypeError(n)}function s(e,t){var n=Re(e);return n&&n.has(t)}function c(e){function t(n){var r=new f(l,n);e(r),l=n,a=requestAnimationFrame(t)}function n(e){requestAnimationFrame(t),l=e}function r(){return a=requestAnimationFrame(n),s=!1,i}function o(){return cancelAnimationFrame(a),s=!0,i}if(!D(this))return new c(e);if(!q(e))throw new TypeError("arguments[0] is not a valid handler.");var i=this;if(u(c,i),e=e.bind(i),"function"!=typeof e)throw new TypeError("arguments[0].bind() must return a function.");var a,l,s=!0,p={get:function(){return s},set:function(e){(e?o:r)()},__proto__:null};Ie(i,[ce,"run"],r),Ie(i,[fe,"pause"],o),M(i,"paused",p),M(i,re,p)}function f(e,t){this[ae]=(this[ie]=t)-(this[oe]=e)}function p(e,t,n){function r(r){var o,i=!1;return function(){if(e(n,r))o=i?De:(i=!0,Fe);else{if(!i)return;i=!1,o=qe}t(n,r,o)}}function i(e){var t=S(e);return t||(t=r(e),k(e)),y(e,t),h}function a(e){return w(e),h}function l(){return C(),h}function s(){return E(function(e){e()}),h}function f(e){var t=S(e)||r(e);return new c(function(e){v=e,t()})}function d(){return R(),h}function _(){return P(),h}function m(){return v}if(!D(this))return new p(e,t,n);if(!q(e))throw new TypeError("arguments[0] is not a valid handler.");if(!q(t))throw new TypeError("arguments[1] is not a valid handler.");var h=this;u(p,h),e=e.bind(h),t=t.bind(h);var v,b=new o,g=new o,y=Q.bind(b),w=Z.bind(b),E=$.bind(b),C=ee.bind(b),S=K.bind(g),k=Q.bind(g),A=new c(function(e){v=e,s()}),R=A[ce],P=A[fe];Ie(h,[be,"add"],i),Ie(h,[ge,"remove"],a),Ie(h,[ye,"clear"],l),Ie(h,[we,"update"],s),Ie(h,[ue,"createAnimateWith"],f),Ie(h,[le,"animate"],A),Ie(h,[ce,"run"],d),Ie(h,[fe,"pause"],_),Ie(h,[se,"getAnimateParam"],m);var T=new Me(A,re);M(h,"paused",T),M(h,re,T)}function d(e,t){Pe(e,this),this.object=e;var n=t[ce],r=t[fe],o=this._republic=new O(function(e){(e?r:n)()});this.__add=o[be],this.__remove=o[ge],this.__execute=o[we]}function _(e){if(!D(this))return new _(e);l(c,e,"arguments[0] must be an animate."),u(_,this);var t=new d(this,e);je(this,be,t,"add"),je(this,ge,t,"remove"),je(this,we,t,"execute")}function m(e){Pe(e,this),this.object=e;var t=this._civilian=new U;this.__enter=t.enter,this.__leave=t.leave,this.__request=t.request,this.__unrequest=t.unrequest}function h(){if(!D(this))return new h;u(h,this);var e=new m(this);je(this,be,e,"enter"),je(this,ge,e,"leave"),je(this,ce,e,"request"),je(this,fe,e,"unrequest")}function v(e){if(!D(this))return new v(e);if(!q(e))throw new TypeError("arguments[0] is not a valid handler.");e=e.bind(this),Ie(this,[ue,"createAnimate"],function(t,n){return new c(function(r){e(t,n,r,this)})})}function b(){return Be||this}function g(){return Ge||this}function y(e){if(!D(e))throw new TypeError("arguments[0] must be extensible.");return Ve.has(e)?this:(Ve.add(e),J(e,te),X(te),W(te),H(e,"_kAni_primitivePrototype",j),this)}function w(){return He||this}function E(){if(Je)return Je;var e=V(this);return e("SymbolCollection",b),e(pe,b),e("FunctionCollection",g),e(de,g),y(this),e("ReleaseClasses",y),e(_e,y),e("ClassCollection",w),e(me,w),Je=this}var C=e.document.currentScript,S=e[C.getAttributeNS(null,"kjslib-keyword")||"_kJs_Initor"];if(!S)throw new Error("-k-js-abstract.js is required.");var k=C.getAttributeNS(null,"kanilib-keyword")||"_kAni_Initor",A=new S,R=A.SymbolCollection(),P=A.FunctionCollection(),T=t.create,M=t.defineProperty,I=A.ClassCollection(),j=T(I._primitive_prototype),L=T(j);A.ReleaseMethods(j),A.ReleaseMethods(L);var x=n.prototype,N=(x.call,x.bind),O=I.Republic,U=I.Civilian,F=P.shared_toString,D=P.is_extensible_object,q=P.is_valid_handler,B=t.freeze,G=L._kJs_setConst,V=N.bind(G),H=P.__setConst,J=P.__addSetConsts,X=P.__executePropertyMappers,W=P.__clearAllPropertyMappers,Y=(L._kJs_addSetConsts,L._kJs_executePropertyMappers,L._kJs_clearAllPropertyMappers,o.prototype),z=i.prototype,K=Y.get,Q=Y.set,Z=Y["delete"],$=Y.forEach,ee=Y.clear,te=(z.add,z["delete"],Date.now,T(null),T(null)),ne=T(j),re=r("check if paused"),oe=r("last executed timepoint"),ie=r("current timepoint"),ae=r("duration"),ue=r("create an animate"),le=r("one unique animate"),se=r("get animate parameters from animate"),ce=R.request,fe=R.unrequest,pe=R.SymbolCollection,de=R.FunctionCollection,_e=R.ReleaseClasses,me=R.ClassCollection,he=R.createdInstance,ve=R.primitivePrototype,be=R.addMember,ge=R.removeMember,ye=R.clear,we=R.update,Ee=B({isPaused:re,lastTime:oe,currentTime:ie,duration:ae,createAnimate:ue,animate:le,getAnimateParam:se,__proto__:null}),Ce=B({_prvEnsureConstructor:l,_prvCheckConstructorInstance:s,__proto__:null}),Se=new o,ke=new o,Ae=Q.bind(Se),Re=K.bind(Se),Pe=Q.bind(ke),Te=K.bind(ke),Me=P._DescriptorGetterSetter1os3b,Ie=P._setconst1oVs1v,je=(P._setmtdfromcore2o1s,P._setmtdfromcore2os),Le=P._setkeytokey1o2s3b,xe=P._setkeytokey1o2s3b_inheritable,Ne=(P._defgettersetter1o2s,C.getAttributeNS(null,"kani-enum-type"));Ne&&(Ne=Ne.toLocaleString());var Oe,Ue;switch(Ne){case"int":case"integer":case"number":!function(){var e=0,t=0;Oe=function(){var t=e;return e+=1<<level,t},Ue=function(n){e=0,t=n>>0}}();break;default:e.console.warn("Attribute 'kani-enum-type' of this script element is set to an invalid value. Enum type will be Symbol by default.",C,C.getAttributeNodeNS(null,"kani-enum-type"));case null:case"symbol":Oe=function(e){return r(e)},Ue=x}a(c,function(e){var t=V(e);return t("run",null),t("pause",null),t("paused",!0),t(re,!0),t(ce,null),t(fe,null),e}(T(j))),te._kAni_Animate=ne.Animate=c,c.toString=F,c.user_manuals=["constructor Animate(function<void, Animate, AnimateParam> callback);"],function(e){var t=e.prototype=T(j);H(c,"prvAnimateParam_prototype",t),xe(!0),Le(t,"now",ie),Le(t,"last",oe),Le(t,"duration",ae),t[ie]=null,t[oe]=null,t[ae]=0}(f),Ue(0);var Fe=Oe("Stage.FIRST_IMPACT"),De=Oe("Stage.WHILE_IMPACT"),qe=Oe("Stage.AFTER_IMPACT");!function(e){var t=V(e);t("FIRST_IMPACT",Fe),t("WHILE_IMPACT",De),t("AFTER_IMPACT",qe)}(p),a(p,function(e){var t=V(e);return t("add",null),t("remove",null),t("clear",null),t("update",null),t("createAnimateWith",null),t("animate",null),t("run",null),t("pause",null),t("getAnimateParam",null),t("paused",null),t(be,null),t(ge,null),t(ye,null),t(we,null),t(ue,null),t(le,null),t(ce,null),t(fe,null),t(se,null),t(re,null),t("FIRST_IMPACT",Fe),t("WHILE_IMPACT",De),t("AFTER_IMPACT",qe),e}(T(j))),te._kAni_Stage=ne.Stage=p,p.toString=F,p.user_manuals=["constructor Stage(ImpactDetector impact_detector, ImpactHandler impact_handler, LActor l_actor);","typedef function<bool, Stage, LActor, RActor> ImpactDetector;","typedef function<void, Stage, LActor, RActor, ImpactType> ImpactHandler;","typedef any LActor, RActor;","enum ImpactType { FIRST_IMPACT, WHILE_IMPACT, AFTER_IMPACT }"],d.prototype=T({__add:null,__remove:null,__execute:null,_republic:null,object:null,add:function(e){return l(h,e,"arguments[0] must be an animate civilian."),this.__add(Te(e)._civilian),this.object},remove:function(e){return l(h,e,"arguments[0] must be an animate civilian."),this.__remove(Te(e)._civilian),this.object},execute:function(){return this.__execute(),this.object},__proto__:null}),a(_,function(e){V(e);return e}(T(j))),te._kAni_AnimateRepublic=ne.AnimateRepublic=_,_.toString=F,_.user_manuals=["constructor AnimateRepublic(Animate animate);"],m.prototype=T({__enter:null,__leave:null,__request:null,__unrequest:null,_civilian:null,object:null,enter:function(e){return l(_,e,"arguments[0] must be an animate republic."),this.__enter(Te(e)._republic),this.object},leave:function(e){return l(_,e,"arguments[0] must be an animate republic."),this.__leave(Te(e)._republic),this.object},request:function(){return this.__request(),this.object},unrequest:function(){return this.__unrequest(),this.object},__proto__:null}),a(h,function(e){var t=V(e);return t("enter",null),t("leave",null),t("request",null),t("unrequest",null),t(be,null),t(ge,null),t(ce,null),t(fe,null),e}(T(j))),te._kAni_AnimateCivilian=ne.AnimateCivilian=h,h.toString=F,h.user_manuals=["constructor AnimateCivilian();"],a(v,function(e){var t=V(e);return t("createAnimate",null),t(ue,null),e}(T(j))),te._kAni_VectorAnimator=ne.VectorAnimator=v,v.toString=F,v.user_manuals=["constructor VectorAnimator(function<void, VectorAnimator, LVec, RVec, AnimateParam, Animate> vecadder);","typedef any LVec, RVec;"];var Be=null;b.prototype=Ee,b.toString=F,b.user_manuals=["constructor Initor::SymbolCollection();"],b[he]=b.created=Be=new b,B(b);var Ge=null;g.prototype=Ce,g.toString=F,g.user_manuals=["constructor Initor::FunctionCollection();"],g[he]=g.created=Ge=new g,B(g);var Ve=new i;y.toString=F,y.user_manuals=["constructor Initor::ReleaseClasses(Object object);"],ne._primitive_prototype=ne[ve]=j;var He=null;w.prototype=B(ne),w.toString=F,w.user_manuals=["constructor Initor::ClassCollection();"],w[he]=w.created=He=B(new w),B(w);var Je=null;e[k]=E,E.toString=F,E.user_manuals=["constructor Initor();"],E.prototype=T(j),E[he]=E.created=Je=B(new E),B(E)}(window,Object,Function,Symbol,Map,Set),function(e,t,n,r,o,i){"use strict";function a(e,t){we(e,new o),e.prototype=t}function u(e,t){var n=ge.get(e);if(n.has(t))throw new TypeError("Can't re-construct object. 'new' operator is required.");n.add(t)}function l(e,t,n){if(!s(e,t))throw new TypeError(n)}function s(e,t){var n=Ee(e);return n&&n.has(t)}function c(e){return"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}function f(e,t){var n=q(this);n("type",e),n("event",t)}function p(e){function t(e,t){function n(e,t){return a(new f(e,t))}function r(e){n("request",e)||(w(),h())}if(!c(e))throw new TypeError("arguments[0] is not a valid event target.");if("object"!=typeof t||!t)throw new TypeError("arguments[1] must be an object.");var o=t.requestonly;if("boolean"!=typeof o)throw new TypeError("arguments[1].requestonly must be a boolean.");var i=this,a=t.preventor;switch(typeof a){case"function":a=I.call(a,i);break;case"object":if(!a){a=T;break}if(!U(a))throw new TypeError("arguments[1].preventor must be either undefined, null, a function, or a functor.");a=a.bind(i);break;case"undefined":a=T;break;default:throw new TypeError("arguments[1].preventor must be either undefined, null, a function, or a functor.")}g(i);var u,l,s=new x,p=!1,d=e.addEventListener.bind(e),v=e.removeEventListener.bind(e),b=t.request_event_type,y=t.request_use_capture,w=s[le];o?(u=function(){return p=!0,_(s),d(b,r,y),i},l=function(){return p=!1,m(s),v(b,r,y),i}):!function(){function e(e){n("unrequest",e)||(c(),h())}var o=t.unrequest_event_type,a=t.unrequest_use_capture,c=s[se];u=function(){return p=!0,_(s),d(b,r,y),d(o,e,a),i},l=function(){return p=!1,m(s),v(b,r,y),v(o,e,a),i}}();var E={get:function(){return p},set:function(e){(e?u:l)()},__proto__:null};Se(i,[ce,"enable"],u),Se(i,[fe,"disable"],l),k(i,"enabled",E),k(i,pe,E)}function n(e,n){return new t(e,n)}function r(e){return l(e),e[ce](),s}function i(e){return l(e),e[fe](),s}function a(e){return l(e),e[pe]}function l(e){if(!b(e))throw new TypeError("arguments[0] is not a valid event republic.")}if(!O(this))return new p(e);if(!U(e))throw new TypeError("arguments[0] is not a valid handler.");var s=this;u(p,s);var d=new L(e.bind(s)),_=d[ie],m=d[ae],h=d[ue],v=new o,b=Q.bind(v),g=K.bind(v);t.prototype=S(Ae);B(t,"_event_preventor_param_",ke),Se(s,[oe,"create"],n),Se(s,[ce,"enable"],r),Se(s,[fe,"disable"],i),Se(s,[pe,"isEnabled"],a)}function d(e){function t(e){var t=h(e);t||(t=_(e,{requestonly:!0,request_event_type:"loadend",request_use_capture:!1,__proto__:null}),v(e,t)),t.enable()}function n(e){var t=h(e);t&&t.disable()}function o(e){return t(e),c}function a(e){return n(e),c}function u(e,n,r){var o=new i;return t(o),function(){e&&(ee(o,e,n),r&&te(o))}(),o}function l(){return b(),c}function s(){return g(),c}if(!O(this))return new d(e);if(!U(e))throw new TypeError("arguments[0] is not a valid handler.");var c=this,f=new p(e.bind(c)),_=f.create,m=new r,h=Y.bind(m),v=z.bind(m),b=f[ce],g=f[fe];Se(c,[ie,"add"],o),Se(c,[ae,"remove"],a),Se(c,[oe,"create"],u),Se(c,[ce,"enable"],l),Se(c,[fe,"disable"],s);var y=new Ce(f,pe);k(c,"enabled",y),k(c,pe,y)}function _(){return Re||this}function m(e){if(!O(e))throw new TypeError("arguments[0] must be extensible.");return Pe.has(e)?this:(Pe.add(e),G(e,ne),V(ne),H(ne),B(e,"_kEvent_primitivePrototype",R),this)}function h(){return Te||this}function v(){if(Me)return Me;var e=q(this);return e("FunctionCollection",_),e(de,_),m(this),e("ReleaseClasses",m),e(_e,m),e("ClassCollection",h),e(me,h),Me=this}var b=e.document.currentScript,g=e[b.getAttributeNS(null,"kjslib-keyword")||"_kJs_Initor"];if(!g)throw new Error("-k-js-abstract.js is required.");var y=b.getAttributeNS(null,"keventlib-keyword")||"_kEvent_Initor",w=new g,E=w.SymbolCollection(),C=w.FunctionCollection(),S=t.create,k=t.defineProperty,A=w.ClassCollection(),R=S(A._primitive_prototype),P=S(R);w.ReleaseMethods(R),w.ReleaseMethods(P);var T=n.prototype,M=T.call,I=T.bind,j=I.bind(M),L=A.Republic,x=A.Civilian,N=C.shared_toString,O=C.is_extensible_object,U=C.is_valid_handler,F=t.freeze,D=P._kJs_setConst,q=I.bind(D),B=C.__setConst,G=C.__addSetConsts,V=C.__executePropertyMappers,H=C.__clearAllPropertyMappers,J=(P._kJs_addSetConsts,P._kJs_executePropertyMappers,P._kJs_clearAllPropertyMappers,r.prototype),X=o.prototype,W=i.prototype,Y=J.get,z=J.set,K=(J["delete"],J.forEach,J.clear,X.add),Q=(X["delete"],X.has),Z=W.open,$=W.send,ee=j(Z),te=j($),ne=(S(null),S(null)),re=S(R),oe=E.create,ie=E.addMember,ae=E.removeMember,ue=E.update,le=E.request,se=E.unrequest,ce=E.enable,fe=E.disable,pe=E.enabled,de=(E.SymbolCollection,E.FunctionCollection),_e=E.ReleaseClasses,me=E.ClassCollection,he=E.createdInstance,ve=E.primitivePrototype,ie=E.addMember,ae=E.removeMember,be=F({is_valid_event_target:c,_prvEnsureConstructor:l,_prvCheckConstructorInstance:s,__proto__:null}),ge=new r,ye=new r,we=z.bind(ge),Ee=Y.bind(ge),Ce=(z.bind(ye),Y.bind(ye),C._DescriptorGetterSetter1os3b),Se=C._setconst1oVs1v,ke=(C._setmtdfromcore2o1s,C._setmtdfromcore2os,C._setkeytokey1o2s3b,C._setkeytokey1o2s3b_inheritable,C._defgettersetter1o2s,f.prototype=function(e){var t=q(e);return t("type",null),t("event",null),e}(S(R)));B(p,"_event_preventor_param_",ke);var Ae=function(e){var t=q(e);return t("enable",null),t("disable",null),t("enabled",null),t(ce,null),t(fe,null),t(pe,null),e}(S(R));B(p,"_event_civilian_",Ae),a(p,function(e){var t=q(e);return t("create",null),t("enable",null),t("disable",null),t("isEnabled",null),t(oe,null),t(ce,null),t(fe,null),t(pe,null),e}(S(R))),ne._kEvent_EventRepublic=re.EventRepublic=p,p.toString=N,p.user_manuals=["constructor EventRepublic(function<void, EventRepublic, uint> handler);"],a(d,function(e){var t=q(e);return t("add",null),t("remove",null),t("create",null),t("enable",null),t("disable",null),t(ie,null),t(ae,null),t(oe,null),t(ce,null),t(fe,null),e}(S(R))),ne._kEvent_XHRCount=re.XHRCount=d,d.toString=N,d.user_manuals=["constructor XHRCount(function<void, XHRCount, uint> handler);"];var Re=null;_.prototype=be,_.toString=N,_.user_manuals=["constructor Initor::FunctionCollection();"],_[he]=_.created=Re=new _,F(_);var Pe=new o;m.toString=N,m.user_manuals=["constructor Initor::ReleaseClasses(Object object);"],re._primitive_prototype=re[ve]=R;var Te=null;h.prototype=F(re),h.toString=N,h.user_manuals=["constructor Initor::ClassCollection();"],h[he]=h.created=Te=F(new h),F(h);var Me=null;e[y]=v,v.toString=N,v.user_manuals=["constructor Initor();"],v.prototype=S(R),v[he]=v.created=Me=F(new v),F(v)}(window,Object,Function,Map,Set,XMLHttpRequest),function(e,t,n,r,o,i,a,u,l,s){"use strict";function c(e,t){vn(e,new i),e.prototype=t}function f(e,t,n){if(!p(e,t))throw new TypeError(n)}function p(e,t){var n=bn(e);return n&&n.has(t)}function d(e){function t(e,t,n){e.prototype=t,H(n,t)}function n(t){var n=B(t);n("gl",e),n("glUtil",V),n(sn,e),n(cn,V)}function r(e,t,n){!function r(e){if(null===e||e===b)return n(e);var o;if(e instanceof a)o=re;else{if(R(e)!==W)return t(e);o=te}o(e,function(e){r(e)})}(e)}function o(e,t){var n=t.oncreated;if(n!==b&&null!==n){if("function"==typeof n)return O(n,V,e);throw console.warn("Value of 'descriptor.oncreated' is invalid: ",n),new TypeError("Property 'oncreated' of parameter 'descriptor' must be either undefined, null, or a function.")}}function l(e,t){var n=t.onerror;if(n===b||null===n)throw e;if("function"==typeof n)return O(n,V,e);throw console.warn("Property 'onerror' of parameter 'descriptor' should be a function or undefined or null."),e}function s(t){function n(t,n,r,i,a,u){var l=this,s=We(e,t),c=ze(e,t,n,r,i,a,u),f=B(l);f("attribLocation",t),f("size",n),f("type",r),f("normalized",i),f("stride",a),f("offset",u),f("active",s),f("set",c),f("createBuffer",function(e,t,n){var r=U(new o(e,t,n));return c(),r}),f("createBufferUtil",function(e,t,n){var r=q(new o(e,t,n));return c(),r}),f(ln,t)}function r(n,r,o){var i,a;switch(r){case"float":a={1:Qe,2:$e,3:tt,4:rt,__proto__:null};break;case"int":a={1:it,2:ut,3:st,4:ft,__proto__:null};break;case"fvec":a={1:dt,2:mt,3:vt,4:gt,__proto__:null};break;case"ivec":a={1:wt,2:Ct,3:kt,4:Rt,__proto__:null};break;case"fmat":a={2:Tt,3:It,4:Lt,__proto__:null};break;default:throw new RangeError("Parameter 'type' must be either 'float', 'int', 'fvec', 'ivec' or 'fmat'.")}if(i=a[o],"function"!=typeof i)throw new RangeError("Parameter 'length' is invalid: length = "+o);var u=B(this);u("get",Te(e,t,n)),u("set","fmat"==r?i(e,n,0):i(e,n)),u("uniformLocation",n),u(ln,n)}function o(e,t,n){this.target=e,this.usage=t,this.data=n}function i(e){f(e[ln])}function a(e){m(e[ln])}function u(e,t,r,o,i,a){return new n(h(e),t,r,o,i,a)}function l(e,t,n){return new r(v(e),t,n)}var s=this,f=we(e,t),p=new c(s,t),d=n.prototype=function(e){var t=B(e);return t("attribLocation",null),t("size",null),t("type",null),t("normalized",null),t("stride",null),t("offset",null),t("active",null),t("set",null),t("createBuffer",null),t("createBufferUtil",null),t(ln,null),e}(k(p)),_=r.prototype=function(e){var t=B(e);return t("get",null),t("set",null),t("uniformLocation",null),t(ln,null),A(e,"value",{get:function(){return this.get()},set:function(e){this.set(e)},__proto__:null}),e.valueOf=function(e){return this[e===b?"get":"set"](e)},e}(k(p));o.prototype=k({bind:1,target:null,usage:null,data:null,__proto__:null});var m=Ce(e,t),h=ke(e,t),v=Re(e,t),g=Le(e,t),y=Ne(e,t),w=Be(e,t),E=B(s);E("program",t),E("attachShader",f),E("attachShaderUtil",i),E("detachShader",m),E("detachShaderUtil",a),E("getAttribLocation",h),E("createAttribUtil",u),E("getUniformLocation",v),E("createUniformUtil",l),E("getParameter",g),E("getInfoLog",y),E("destroy",w),E("_variable_util_",p),E("_attrib_util_",d),E("_uniform_util_",_),E(ln,t),E(fn,g),E(pn,y),E(dn,w)}function c(e,t){var n=B(this);n("program",t),n("programUtil",e),n(sn,t),n(cn,e)}function f(t){function n(e){if(v(),!s(Wt)){var n=new w(t,c(),g());if(G(n,"shaderUtil",m),e===b||null===e)throw n;if("function"==typeof e)return O(e,V,n);throw console.warn("Parameter 'onerror' should be a function or undefined or null."),n}}function r(e){switch(typeof e){case"string":return y(e);case"object":if(!e)break;var t=e.source;if("string"!=typeof t)throw new TypeError("Property 'source' of parameter 'descriptor' must be a string.");return y(t),void(e.compile&&n(e.onerror))}throw new TypeError("Parameter 'descriptor' must be either a string or an object.")}function o(e){ne(e,t)}function i(e){ne(e[ln],t)}function a(e){oe(e,t)}function u(e){oe(e[ln],t)}if(t){var l,s=Ue(e,t),c=De(e,t),f=Ve(e,t),d=s(Yt);switch(d){case zt:l=p;break;case Kt:l=_;break;default:throw new TypeError("Invalid shader. SHADER_TYPE: "+String(d))}var m=new l,h=B(m),v=ge(e,t),g=me(e,t),y=ve(e,t),E=g;return h("shader",t),A(m,"source",{get:E,set:r,__proto__:null}),h("compile",n),h("getSource",E),h("setSource",r),h("attachProgram",o),h("attachProgramUtil",i),h("detachProgram",a),h("detachProgramUtil",u),h("getParameter",s),h("getInfoLog",c),h("destroy",f),h(ln,t),h(fn,s),h(pn,c),h(dn,f),m}}function p(){}function _(){}function m(t,n){var r=this,o=B(r),i=Nt(e,n,t),a=Ut(e,n),u=Dt(e,n),l=Bt(e,n),s=Je(e,t);o("buffer",t),o("target",n),A(r,"size",{get:Bt(e,n,Qt),__proto__:null}),A(r,"usage",{get:Bt(e,n,Zt),__proto__:null}),A(r,"valid",{get:Vt(e,t),__proto__:null}),o("bind",i),o("passData",a),o("passSubData",u),o("getParameter",l),o("destroy",s),o(ln,D({0:t,1:n,buffer:t,target:n,__proto__:{toString:function(){return t},valueOf:function(){return n},__proto__:null}})),o(dn,s)}function h(e){G(this,"name",e)}function v(e){G(this,"errorType",e)}function g(e,t){var n=B(this);n("details",new y(e,t)),n("message",t),n("stack",(new Error).stack)}function y(e,t){var n=B(this);n("program",e),n("infoLog",t)}function w(e,t,n){var r=B(this);r("details",new E(e,t,n)),r("message",t),r("stack",(new Error).stack)}function E(e,t,n){var r=B(this);r("shader",e),r("infoLog",t),r("source",n)}function C(e){if(e===b||null===e)return J();if("object"!=typeof e)throw new TypeError("Parameter 'descriptor' must be either an object or null or undefined.")}function S(e){function t(t,r,o,i){var a,u=e[t];if(u!==b&&null!==u){switch(typeof u){case"string":a=j({type:r,source:u,compile:!0,__proto__:null});break;case"object":switch(R(u)){case Q:if(a=u,he(u,Yt)!==r)throw console.warn(a," has invalid shader type: ",r),new TypeError("Invalid shader type: "+r);break;case o:console.warn(u," is invalid."),a=u[ln];break;case i:throw new TypeError("Invalid shader type.");default:a=j({type:r,compile:!0,__proto__:u})}break;default:throw new TypeError("Property '"+t+"' of parameter must be either null, undefined, a string, a WebGLShader, a ShaderUtil, or a descriptor<WebGLShader>")}ne(n,a)}}if(e instanceof a||e instanceof i)return P({shader:e,use:e.use,link:e.link,onerror:e.onerror,__proto__:null});var n=J();t("vertexShader",Kt,ye,Ee),t("fragmentShader",zt,Ee,ye);var r=e.use;return(e.link||r)&&(z(n),pe(n,Xt)?r&&Z(n):l(new g(n,_e(n)),e)),o(n,e),n}function P(e){return C(e)||S(e)}function T(e){return new s(C(e)||(R(e)===K?e:S(e)))}function M(e){if("object"!=typeof e||!e)throw new TypeError("Parameter 'descriptor' must be an object")}function j(e){var t=X(e.type);if(!t)throw new TypeError("Creating shader failed because given 'descriptor.type' has wrong value.");var n=e.source,i=e.compile;return n&&($(t,n),i&&(ee(t),he(t,Wt)||l(new w(t,be(t),n),e))),r(e.program,function(e){ne(R(e)===K?e:P(e),t)},I),o(t,e),t}function L(e){return M(e),j(e)}function x(e){return M(e),new f(R(e)===Q?e:j(e))}function N(e,t){if("object"!=typeof t||!t)throw new TypeError("Parameter 'descriptor' must be an object.");var n=t.bind,r=t.target,o=t.data;if(o===b&&(o=t.size),n&&ae(r,e),o){var i=t.usage;le(r,o,i)}return r}function U(e){var t=Y();return N(t,e),t}function q(e){var t=Y(),n=N(t,e);if(n!=$t&&n!=en)throw new TypeError("Property 'target' of parameter 'descriptor' must be either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER");return new m(t,n)}if(!F(this))return new d(e);if(!(e instanceof u))throw new TypeError("Parameter 'gl' must be a WebGLRenderingContext.");var V=this,H=B(V),J=ie(e),X=ue(e),Y=se(e),z=fe(e),Z=de(e),$=ve(e),ee=ge(e),ne=we(e),oe=Ce(e),ae=Nt(e),le=Ut(e),ce=Ie(e),pe=Le(e),_e=Ne(e),he=Ue(e),be=De(e);!function(e){t(s,e,"_program_util_"),n(e)}(k(wn)),function(e){t(c,e,"_variable_util_"),n(e)}(k(Sn)),function(e){t(f,e,"_shader_util_"),n(e)}(k(En));var ye=function(e){return t(p,e,"_fragment_shader_util_"),e}(new f(null)),Ee=function(e){return t(_,e,"_vertex_shader_util_"),e}(new f(null));!function(e){t(m,e,"_buffer_util_"),n(e)}(k(Cn)),function(e){t(h,e,"_gl_error_"),n(e)}(k(kn)),function(e){t(v,e,"_gl_error_details_"),n(e)}(k(An)),function(e){t(g,e,"_program_linking_error_")}(new h("ProgramLinkingError")),function(e){t(y,e,"_program_linking_error_details_"),n(e);var r=B(e);r("program",null),r("infoLog",null)}(new v("ProgramLinkingError")),function(e){t(w,e,"_shader_compiling_error_")}(new h("ShaderCompilingError")),function(e){t(E,e,"_shader_compiling_error_details_"),n(e);var r=B(e);r("shader",null),r("infoLog",null),r("source",null)}(new v("ShaderCompilingError")),H("gl",e),H("createProgram",P),H("createProgramUtil",T),H("createShader",L),H("createShaderUtil",x),H("createBuffer",U),H("createBufferUtil",q),H("getParameter",ce),H("getProgramParameter",pe),H("getProgramInfoLog",_e),H("getShaderParameter",he),H("getShaderInfoLog",be),H(ln,e),H(tn,T),H(fn,ce)}function _(){return Rn||this}function m(e){if(!F(e))throw new TypeError("arguments[0] must be extensible.");return Pn.has(e)?this:(Pn.add(e),V(e,Ht),H(Ht),J(Ht),G(e,"_kGraph_primitivePrototype",T),this)}function h(){return Tn||this}function v(){if(Mn)return Mn;var e=B(this);return e("FunctionCollection",_),e(nn,_),m(this),e("ReleaseClasses",m),e(rn,m),e("ClassCollection",h),e(on,h),Mn=this}var b,g=e.document.currentScript,y=e[g.getAttributeNS(null,"kjslib-keyword")||"_kJs_Initor"];if(!y)throw new Error("-k-js-abstract.js is required.");var w=g.getAttributeNS(null,"kgraphlib-keyword")||"_kGraph_Initor",E=new y,C=E.SymbolCollection(),S=E.FunctionCollection(),k=t.create,A=t.defineProperty,R=t.getPrototypeOf,P=E.ClassCollection(),T=k(P._primitive_prototype),M=k(T);E.ReleaseMethods(T),E.ReleaseMethods(M);var I=n.prototype,j=I.call,L=I.bind,x=L.bind(j),N=L.bind(L),O=j.bind(j),U=S.shared_toString,F=S.is_extensible_object,D=(S.is_valid_handler,t.freeze),q=M._kJs_setConst,B=L.bind(q),G=S.__setConst,V=S.__addSetConsts,H=S.__executePropertyMappers,J=S.__clearAllPropertyMappers,X=o.prototype,W=i.prototype,Y=a.prototype,z=u.prototype,K=l.prototype,Q=s.prototype,Z=X.get,$=X.set,ee=(W.add,W["delete"],W.has,W.forEach),te=x(ee),ne=Y.forEach,re=x(ne),oe=z.createProgram,ie=N(oe),ae=z.createShader,ue=N(ae),le=z.createBuffer,se=N(le),ce=z.linkProgram,fe=N(ce),pe=z.useProgram,de=N(pe),_e=z.getShaderSource,me=N(_e),he=z.shaderSource,ve=N(he),be=z.compileShader,ge=N(be),ye=z.attachShader,we=N(ye),Ee=z.detachShader,Ce=N(Ee),Se=z.getAttribLocation,ke=N(Se),Ae=z.getUniformLocation,Re=N(Ae),Pe=z.getUniform,Te=N(Pe),Me=z.getParameter,Ie=N(Me),je=z.getProgramParameter,Le=N(je),xe=z.getProgramInfoLog,Ne=N(xe),Oe=z.getShaderParameter,Ue=N(Oe),Fe=z.getShaderInfoLog,De=N(Fe),qe=z.deleteProgram,Be=N(qe),Ge=z.deleteShader,Ve=N(Ge),He=z.deleteBuffer,Je=N(He),Xe=z.enableVertexAttribArray,We=N(Xe),Ye=z.vertexAttribPointer,ze=N(Ye),Ke=z.uniform1f,Qe=N(Ke),Ze=z.uniform2f,$e=N(Ze),et=z.uniform3f,tt=N(et),nt=z.uniform4f,rt=N(nt),ot=z.uniform1i,it=N(ot),at=z.uniform2i,ut=N(at),lt=z.uniform3i,st=N(lt),ct=z.uniform4i,ft=N(ct),pt=z.uniform1fv,dt=N(pt),_t=z.uniform2fv,mt=N(_t),ht=z.uniform3fv,vt=N(ht),bt=z.uniform4fv,gt=N(bt),yt=z.uniform1iv,wt=N(yt),Et=z.uniform2iv,Ct=N(Et),St=z.uniform3iv,kt=N(St),At=z.uniform4iv,Rt=N(At),Pt=z.uniformMatrix2fv,Tt=N(Pt),Mt=z.uniformMatrix3fv,It=N(Mt),jt=z.uniformMatrix4fv,Lt=N(jt),xt=z.bindBuffer,Nt=N(xt),Ot=z.bufferData,Ut=N(Ot),Ft=z.bufferSubData,Dt=N(Ft),qt=z.getBufferParameter,Bt=N(qt),Gt=z.isBuffer,Vt=N(Gt),Ht=(M._kJs_addSetConsts,
M._kJs_executePropertyMappers,M._kJs_clearAllPropertyMappers,k(null),k(null)),Jt=k(T),Xt=z.LINK_STATUS,Wt=z.COMPILE_STATUS,Yt=z.SHADER_TYPE,zt=z.FRAGMENT_SHADER,Kt=z.VERTEX_SHADER,Qt=z.BUFFER_SIZE,Zt=z.BUFFER_USAGE,$t=z.ARRAY_BUFFER,en=z.ELEMENT_ARRAY_BUFFER,tn=(z.BOOL,z.BYTE,z.SHORT,z.INT,z.UNSIGNED_BYTE,z.UNSIGNED_SHORT,z.UNSIGNED_INT,z.FLOAT,z.BOOL_VEC2,z.BYTE_VEC2,z.SHORT_VEC2,z.INT_VEC2,z.UNSIGNED_BYTE_VEC2,z.UNSIGNED_SHORT_VEC2,z.UNSIGNED_INT_VEC2,z.FLOAT_VEC2,z.BOOL_VEC3,z.BYTE_VEC3,z.SHORT_VEC3,z.INT_VEC3,z.UNSIGNED_BYTE_VEC3,z.UNSIGNED_SHORT_VEC3,z.UNSIGNED_INT_VEC3,z.FLOAT_VEC3,z.BOOL_VEC4,z.BYTE_VEC4,z.SHORT_VEC4,z.INT_VEC4,z.UNSIGNED_BYTE_VEC4,z.UNSIGNED_SHORT_VEC4,z.UNSIGNED_INT_VEC4,z.FLOAT_VEC4,z.FLOAT_MAT2,z.FLOAT_MAT3,z.FLOAT_MAT4,C.create),nn=(C.SymbolCollection,C.FunctionCollection),rn=C.ReleaseClasses,on=C.ClassCollection,an=C.createdInstance,un=C.primitivePrototype,ln=r("Based object"),sn=r("Context's based object"),cn=r("Context"),fn=r("Get parameter"),pn=r("Get info log"),dn=r("WebGLObject destructor"),_n=(D({basedObject:ln,parentBasedObject:sn,parentObject:cn,getParameter:fn,getInfoLog:pn,destruct:dn,__proto__:null}),D({_prvEnsureConstructor:f,_prvCheckConstructorInstance:p,__proto__:null})),mn=new o,hn=new o,vn=$.bind(mn),bn=Z.bind(mn),gn=($.bind(hn),Z.bind(hn),S._DescriptorGetterSetter1os3b,S._setconst1oVs1v,S._setmtdfromcore2o1s,S._setmtdfromcore2os,S._setkeytokey1o2s3b,S._setkeytokey1o2s3b_inheritable,S._defgettersetter1o2s,function(e){var t=B(e);return t("gl",null),t("glUtil",null),t(sn,null),t(cn,null),e}(k(T))),yn={get:function(){return this[pn]()},__proto__:null},wn=function(e){var t=B(e);return t("program",null),A(e,"infoLog",yn),t("createShader",null),t("createShaderUtil",null),t("getAttribLocation",null),t("createAttribUtil",null),t("getUniformLocation",null),t("createUniformUtil",null),t("getParameter",null),t("getInfoLog",null),t("destroy",null),t(ln,null),t(fn,null),t(pn,null),t(dn,null),e}(k(gn)),En=function(e){var t=B(e);return t("shader",null),t("source",null),A(e,"infoLog",yn),A(e,"attachedShaders",{get:function(){return this[sn].getAttachedShaders(this[ln])},__proto__:null}),t("getSource",null),t("setSource",null),t("compile",null),t("attachProgram",null),t("attachProgramUtil",null),t("detachProgram",null),t("detachProgramUtil",null),t("getParameter",null),t("getInfoLog",null),t("destroy",null),e.valueOf=function(e){return this[e===b?"getSource":"setSource"](e)},t(ln,null),t(fn,null),t(pn,null),t(dn,null),e}(k(gn)),Cn=function(e){var t=B(e);return t("buffer",null),t("target",null),t("size",null),t("usage",null),t("valid",!1),t("passData",null),t("passSubData",null),t("getParameter",null),t(fn,null),e}(k(gn)),Sn=function(e){var t=B(e);return t("program",null),t("programUtil",null),e}(k(gn)),kn=function(e){function t(){return this.name+":\n"+this.message}var n=B(e);return n("name",null),n("message",null),n("details",null),n("stack",null),n("toString",t),A(e,"string",{get:t,__proto__:null}),e}(k(gn)),An=function(e){var t=B(e);return t("type",null),t("infoLog",null),e}(k(gn));!function(e){var t=B(e);t("_util_base_",gn),t("_program_util_",wn),t("_variable_util_",Sn),t("_gl_error_",kn),t("_gl_error_details_",An)}(d),c(d,function(e){var t=B(e);return t("gl",null),t("createProgram",null),t("createProgramUtil",null),t("createShader",null),t("createShaderUtil",null),t("getParameter",null),t("getProgramParameter",null),t("getProgramInfoLog",null),t("getShaderParameter",null),t("getShaderInfoLog",null),t("_program_util_",wn),t("_shader_util_",En),t("_fragment_shader_util_",null),t("_vertex_shader_util_",null),t("_variable_util_",null),t("_buffer_util_",Cn),t("_gl_error_",kn),t("_gl_error_details_",An),t("_program_linking_error_",null),t("_program_linking_error_details_",null),t("_shader_compiling_error_",null),t("_shader_compiling_error_details_",null),t(ln,null),t(tn,null),t(fn),e}(k(T))),Ht._kGraph_GLUtil=Jt.GLUtil=d,d.toString=U,d.user_manuals=["constructor GLUtil(WebGLRenderingContext gl);"];var Rn=null;_.prototype=_n,_.toString=U,_.user_manuals=["constructor Initor::FunctionCollection();"],_[an]=_.created=Rn=new _,D(_);var Pn=new i;m.toString=U,m.user_manuals=["constructor Initor::ReleaseClasses(Object object);"],Jt._primitive_prototype=Jt[un]=T;var Tn=null;h.prototype=D(Jt),h.toString=U,h.user_manuals=["constructor Initor::ClassCollection();"],h[an]=h.created=Tn=D(new h),D(h);var Mn=null;e[w]=v,v.toString=U,v.user_manuals=["constructor Initor();"],v.prototype=k(T),v[an]=v.created=Mn=D(new v),D(v)}(window,Object,Function,Symbol,Map,Set,Array,WebGLRenderingContext,WebGLProgram,WebGLShader),Universe.prototype=Object.create(null),window.universe=new Universe(window,document),Resources.prototype=Object.create(null),window.resources=new Resources(window,document,universe),PatternCollection.prototype=Object.create(null),window.patterncollection=new PatternCollection,main(window,Float32Array);